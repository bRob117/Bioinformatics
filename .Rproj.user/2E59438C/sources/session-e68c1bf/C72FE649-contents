#set working directory
setwd("~/FGCU/BSC4434C/GitHub/Bioinformatics/Lab6")

#load multiple sequence alignment package
library(msa)
library(seqinr)

#import sequence files
e_coli1 <- readDNAStringSet("E_coli1.fasta")
e_coli2 <- readDNAStringSet("E_coli2.fasta")
e_coli3 <- readDNAStringSet("E_coli3.fasta")
e_coli4 <- readDNAStringSet("E_coli4.fasta")
e_coli5 <- readDNAStringSet("E_coli5.fasta")

#combine sequences
e_coli_seqs <- c(e_coli1, e_coli2, e_coli3, e_coli4, e_coli5)

#visualize sequences
print(e_coli_seqs)

#align sequences with MUSCLE
aligned_seqs <- msa(e_coli_seqs, method="Muscle")

#check for gaps
print(aligned_seqs, show="complete")

#measure consensus length
e_coli_consensus <- consensusString(aligned_seqs)
nchar(e_coli_consensus)

#calculate GC content
consensus_vector <- s2c(e_coli_consensus)
GC(consensus_vector)

#convert to seqinr format
seqinr_align <-msaConvert(aligned_seqs, type = c("seqinr::alignment"))

#compute distance matrix
dist_matrix <- dist.alignment(seqinr_align, matrix = "identity")

#view matrix
as.matrix(dist_matrix)

#convert E. coli 1 into amino acid sequence
e_coli1_vec <- s2c("e_coli1")
aa_e_coli1_vec <- translate(e_coli1_vec)
